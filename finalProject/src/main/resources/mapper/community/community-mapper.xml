<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="community">

	<select id="selectList" resultType="com.kh.couplism.community.model.vo.Event">
		SELECT * FROM event ORDER BY eventNo DESC
	</select>
	
	<select id="selectCount" resultType="_int">
		SELECT COUNT(*) FROM event
	</select>
	
	<select id="selectEvent" parameterType="_int" resultType="com.kh.couplism.community.model.vo.Event">
		select * from event where eventNo=#{eventNo}
	</select>
	
	<insert id="insertEvent" parameterType="com.kh.couplism.community.model.vo.Event">
		insert into event values(seq_eventNo.nextval,#{eventTitle},#{eventWriter},#{eventContent},#{eventOriginalFilename},#{eventRenamedFilename},#{couponPrice})
	</insert>
	
	<select id="eventRemove" parameterType="_int">
		delete from event where eventNo=#{eventNo}
	</select>
	
	<select id="selectEventOne" parameterType="_int" resultType="com.kh.couplism.community.model.vo.Event">
		select * from event where eventNo=#{eventNo}
	</select>
	
	<update id="updateEvent" parameterType="com.kh.couplism.community.model.vo.Event">
		update event 
		set eventTitle=#{eventTitle},
			eventContent=#{eventContent},
			eventOriginalFilename=#{eventOriginalFilename},
			eventRenamedFilename=#{eventRenamedFilename},
			couponPrice=#{couponPrice}
		where eventNo=#{eventNo}
	</update>
	
	<insert id="couponDown" parameterType="com.kh.couplism.community.model.vo.Coupon">
		insert into coupon values(#{eventNo},#{eventTitle},#{couponId},#{couponPrice})
	</insert>
	
	<select id="couponSelect" parameterType="string" resultType="com.kh.couplism.community.model.vo.Coupon">
		select * from coupon where couponId=#{couponId}
	</select>
	
	<!--이벤트리스트중에서 랜덤하게 3개만 가져옴  -->
	<select id="threeEventList" resultType="com.kh.couplism.community.model.vo.Event">
		SELECT * FROM
			( SELECT * FROM event
				ORDER BY dbms_random.value )
		WHERE 4>rownum ORDER BY eventNo DESC
	</select>
</mapper>
